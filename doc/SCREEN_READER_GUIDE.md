# 屏幕阅读器功能使用指南

## 概述

校园跳蚤市场现在支持完整的屏幕阅读器功能，让系统能够自动或手动朗读屏幕内容，为视觉障碍用户提供更好的访问体验。

## 🎯 功能特性

### 1. 自动朗读功能
- **页面加载时**：自动朗读页面标题和状态信息
- **内容变化时**：检测到新内容时自动播报
- **交互反馈**：点击商品、表单焦点等自动朗读相关信息

### 2. 手动朗读控制
- **朗读页面标题**：播报当前页面标题
- **朗读页面内容**：播报页面主要内容
- **朗读导航信息**：播报导航菜单内容
- **朗读焦点元素**：播报当前焦点元素信息

### 3. 智能内容识别
- **商品信息**：自动识别并朗读商品标题、价格、描述、位置
- **表单信息**：朗读表单字段和标签
- **搜索结果**：播报搜索结果数量
- **状态信息**：朗读页面状态和提示信息

## 🚀 如何使用

### 开启屏幕阅读功能

1. **开启无障碍功能**：
   - 点击导航栏右侧的无障碍按钮（♿）
   - 或使用快捷键 `Alt + A`

2. **查看朗读控制按钮**：
   - 无障碍功能开启后，会在导航栏显示朗读控制按钮
   - 包含4个按钮：标题朗读、内容朗读、导航朗读、焦点朗读

### 手动朗读操作

#### 方法一：使用按钮
- **📄 朗读页面标题**：点击标题图标按钮
- **📝 朗读页面内容**：点击内容图标按钮  
- **🗺️ 朗读导航信息**：点击导航图标按钮
- **👁️ 朗读焦点元素**：点击焦点图标按钮

#### 方法二：使用键盘快捷键
- `Alt + H`：朗读页面标题
- `Alt + R`：朗读页面内容
- `Alt + N`：朗读导航信息
- `Alt + F`：朗读当前焦点元素

### 自动朗读触发

系统会在以下情况自动朗读内容：

1. **页面加载完成**：自动播报页面状态
2. **点击商品卡片**：自动朗读商品信息
3. **表单获得焦点**：自动朗读表单字段信息
4. **搜索提交**：自动播报搜索结果数量
5. **导航链接焦点**：自动播报导航目标
6. **页面内容变化**：检测到新内容时自动播报

## 🎛️ 朗读内容说明

### 页面标题朗读
- 播报页面标题和主要H1标题
- 格式：`页面标题：[标题内容]`

### 页面内容朗读
- 提取页面主要文本内容
- 自动清理脚本和样式代码
- 限制长度在500字符以内
- 格式：`页面内容：[主要内容摘要]`

### 导航信息朗读
- 播报所有导航菜单项
- 格式：`导航菜单包含：[菜单项1]，[菜单项2]...`

### 商品信息朗读
- 商品标题
- 价格信息
- 商品描述（前100字符）
- 位置信息
- 格式：`商品：[标题]，价格：[价格]，描述：[描述]，位置：[位置]`

### 表单信息朗读
- 所有表单字段标签
- 字段类型信息
- 格式：`表单包含以下字段：[字段1]（类型），[字段2]（类型）...`

### 焦点元素朗读
- 元素描述文本
- 元素类型信息
- aria-label、title、alt等属性
- 格式：`[元素描述]（[元素类型]）`

## 🔧 技术实现

### 屏幕阅读器支持
- 使用 `aria-live` 属性实现实时播报
- `aria-live="polite"`：非紧急信息播报
- `aria-live="assertive"`：紧急信息播报
- `aria-atomic="true"`：完整内容播报

### 内容提取算法
- 智能文本提取，移除脚本和样式
- 文本清理和长度限制
- 语义化内容识别
- 上下文信息补充

### 事件监听
- 页面变化监听（MutationObserver）
- 用户交互监听
- 焦点变化监听
- 表单提交监听

## 🎨 界面说明

### 朗读控制按钮位置
- 位于导航栏右侧，无障碍按钮旁边
- 仅在无障碍功能开启时显示
- 使用蓝色主题色，与无障碍功能保持一致

### 按钮图标说明
- 📄 `fas fa-heading`：朗读页面标题
- 📝 `fas fa-file-text`：朗读页面内容
- 🗺️ `fas fa-sitemap`：朗读导航信息
- 👁️ `fas fa-eye`：朗读焦点元素

## 🔍 使用场景

### 视觉障碍用户
- 通过屏幕阅读器了解页面内容
- 快速获取商品信息
- 导航页面结构

### 认知障碍用户
- 重复听取重要信息
- 理解页面布局
- 确认操作结果

### 老年用户
- 辅助理解页面内容
- 确认操作状态
- 提高使用信心

## ⚠️ 注意事项

1. **浏览器兼容性**：需要支持 `aria-live` 属性的现代浏览器
2. **屏幕阅读器**：需要安装屏幕阅读器软件（如NVDA、JAWS、VoiceOver等）
3. **网络延迟**：内容变化检测可能有500ms-1000ms延迟
4. **内容长度**：页面内容朗读会限制在500字符以内

## 🛠️ 故障排除

### 朗读功能不工作
1. 确认无障碍功能已开启
2. 检查浏览器是否支持aria-live
3. 确认屏幕阅读器软件已安装并运行
4. 检查JavaScript控制台是否有错误

### 朗读内容不准确
1. 检查页面HTML结构是否规范
2. 确认aria-label等属性设置正确
3. 检查内容提取算法是否正常工作

### 按钮不显示
1. 确认无障碍功能已开启
2. 检查CSS样式是否正确加载
3. 确认JavaScript文件正确引入

## 📞 技术支持

如果您在使用屏幕阅读功能时遇到问题，请：
1. 检查浏览器控制台错误信息
2. 确认屏幕阅读器软件状态
3. 联系技术支持团队

---

*本功能遵循WCAG 2.1 AA级无障碍标准，为所有用户提供平等的访问体验。*
